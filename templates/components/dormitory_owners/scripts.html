<!-- Dormitory Owner JavaScript Component -->
<script>
    console.log('Dormitory Owner Scripts loaded');
    // Add Modal Functions
    function openAddModal() {
        console.log('Opening add modal');
        document.getElementById('addModal').classList.remove('hidden');
    }

    function closeAddModal() {
        console.log('Closing add modal');
        document.getElementById('addModal').classList.add('hidden');
        document.getElementById('addForm').reset();
    }

    // Edit Modal Functions
    function editDormitoryOwner(id, name, role) {
        document.getElementById('editStaffId').value = id;
        document.getElementById('editName').textContent = name;
        document.getElementById('editRole').value = role;
        document.getElementById('editModal').classList.remove('hidden');
    }

    function closeEditModal() {
        document.getElementById('editModal').classList.add('hidden');
        document.getElementById('editForm').reset();
    }

    // Delete Modal Functions
    function confirmDelete(id, name, studentCount) {
        document.getElementById('deleteStaffId').value = id;

        let warningMessage = `Are you sure you want to delete dormitory owner "${name}"?`;

        if (studentCount > 0) {
            warningMessage += `<br><br><strong class="text-red-600">Warning:</strong> This dormitory owner has ${studentCount} student(s) assigned. You will need to use Force Delete to remove this dormitory owner.`;
            document.getElementById('deleteForce').checked = true;
        } else {
            document.getElementById('deleteSafe').checked = true;
        }

        document.getElementById('deleteWarning').innerHTML = warningMessage;
        document.getElementById('deleteModal').classList.remove('hidden');
    }

    function closeDeleteModal() {
        document.getElementById('deleteModal').classList.add('hidden');
    }

    // Make sure forms are properly submitted
    document.addEventListener('DOMContentLoaded', function() {
        console.log('DOM loaded, setting up form handlers');

        // Add form submit handler
        const addForm = document.getElementById('addForm');
        if (addForm) {
            addForm.addEventListener('submit', function(e) {
                console.log('Add form submitted');
            });
        }

        // Edit form submit handler
        const editForm = document.getElementById('editForm');
        if (editForm) {
            editForm.addEventListener('submit', function(e) {
                console.log('Edit form submitted');
            });
        }

        // Delete form submit handler
        const deleteForm = document.getElementById('deleteForm');
        if (deleteForm) {
            deleteForm.addEventListener('submit', function(e) {
                console.log('Delete form submitted');
            });
        }
    });

    // Close modals when clicking outside
    window.onclick = function(event) {
        const addModal = document.getElementById('addModal');
        const editModal = document.getElementById('editModal');
        const deleteModal = document.getElementById('deleteModal');

        if (event.target === addModal) {
            closeAddModal();
        } else if (event.target === editModal) {
            closeEditModal();
        } else if (event.target === deleteModal) {
            closeDeleteModal();
        }
    }
</script>
